<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web3 Gacha RPG Game</title>
    <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <!-- Header with connection status -->
        <div class="section">
            <div class="section-header">
                <h1>Web3 Gacha RPG</h1>
                <div>
                    <button id="connect-wallet" class="button">Connect Wallet</button>
                    <span id="wallet-status">Not connected</span>
                </div>
            </div>
            <div>
                <p>Balance: <span id="balance">0</span> Sepolia</p>
            </div>
        </div>

        <!-- Character Inventory Section -->
        <div class="section">
            <div class="section-header">
                <h2>Character Inventory</h2>
                <button id="refresh-inventory" class="button">Refresh</button>
            </div>
            <div id="character-cards" class="character-cards">
                <p>Connect your wallet to view characters.</p>
            </div>
        </div>

        <!-- Gacha Pull Section -->
        <div class="section">
            <div class="section-header">
                <h2>Gacha Pull</h2>
                <p>Cost: 0.0001 Sepolia per pull</p>
            </div>
            <div id="pull-animation" class="pull-animation">
                <div class="orb">
                    <div class="inner-light"></div>
                </div>
                <h2>Pulling...</h2>
            </div>
            <div id="gacha-result" class="gacha-result">
                <h3>You pulled a <span id="pulled-rarity"></span>â˜… character!</h3>
                <p>ID: <span id="pulled-id"></span></p>
                <div id="pulled-character-details"></div>
            </div>
            <button id="pull-button" class="button">Pull Character (0.0001 Sepolia)</button>
        </div>

        <!-- Battle Section -->
        <div class="section">
            <div class="section-header">
                <h2>Battle Arena</h2>
                <p>Win reward: 0.001 Sepolia</p>
            </div>
            <div id="battle-container">
                <select id="character-select">
                    <option value="">-- Select a character to battle --</option>
                </select>
                <div id="battle-area" class="battle-area">
                    <div class="battle-character">
                        <h3>Your Character</h3>
                        <div id="player-character-details"></div>
                        <div class="stat-bar">
                            <div id="player-hp-bar" class="stat-fill hp-fill" style="width: 100%;"></div>
                        </div>
                        <p>HP: <span id="player-current-hp">0</span>/<span id="player-max-hp">0</span></p>
                    </div>
                    <div class="battle-enemy">
                        <h3>Enemy</h3>
                        <div id="enemy-details"></div>
                        <div class="stat-bar">
                            <div id="enemy-hp-bar" class="stat-fill hp-fill" style="width: 100%;"></div>
                        </div>
                        <p>HP: <span id="enemy-current-hp">0</span>/<span id="enemy-max-hp">0</span></p>
                    </div>
                </div>
                <div id="battle-log" class="battle-log"></div>
                <div id="battle-controls" class="battle-controls">
                    <button id="attack-button" class="button">Attack</button>
                    <button id="end-battle" class="button" style="display: none;">End Battle</button>
                </div>
                <button id="start-battle" class="button">Start Battle</button>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script src="config.js"></script>
    <script src="wallet.js"></script>
    <script src="character.js"></script>
    <script src="battle.js"></script>
    <script src="app.js"></script>
    <script>
        console.log("DOM fully loaded");
        console.log("Ethers library available:", typeof ethers !== 'undefined');
        console.log("Window ethereum available:", typeof window.ethereum !== 'undefined');
        
        // Check if MetaMask is installed
        if (typeof window.ethereum === 'undefined') {
          console.log("MetaMask is not installed");
          document.getElementById('notification').textContent = "Please install MetaMask to play this game";
          document.getElementById('notification').className = "notification error";
          document.getElementById('notification').style.display = "block";
        }
      </script>
</body>

</html>